---
version: '1.0'
description: Mistral get host subworkflow
input:
  - host
  - type
output:
  - host: <% ctx().host %>
tasks:
  has_host:
    action: std.noop
    next:
      - when: <% succeeded() and (ctx().host = null or ctx().host = '' or ctx().host = 'None') %>
        do:
          - get_host
      - when: <% succeeded() and (ctx().host != null and ctx().host != '' and ctx().host != 'None') %>
        do:
          - succeed
  get_host:
    action: linux.dig
    input:
      hostname: <% ctx().type %>
      rand:
      count:
    next:
      - when: <% succeeded() %>
        publish:
          - host: <% result().result[0] %>
